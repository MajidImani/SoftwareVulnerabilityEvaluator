/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package softwaresecurityevaluator.datareader;

import com.jcabi.github.Coordinates;
import com.jcabi.github.Github;
import com.jcabi.github.Issue;
import com.jcabi.github.Releases;
import com.jcabi.github.Repo;
import com.jcabi.github.RtGithub;
import java.io.IOException;
import java.time.LocalDateTime;
import java.time.format.DateTimeFormatter;
import java.util.HashMap;
import java.util.Locale;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;

/**
 *
 * @author Majid
 */
public class GithubReleaseVersionReader {

    Map<String, String> softwareVersionMap = new HashMap<String, String>();

    public GithubReleaseVersionReader() {
        softwareVersionMap.put("apache:http_server", "2019-08-14T00:00Z");
        softwareVersionMap.put("nginx:njs", "2019-08-13T00:00Z");
        softwareVersionMap.put("lighttpd:lighttpd", "2019-05-27T00:00Z");
        softwareVersionMap.put("apache:tomcat", "2019-10-11T00:00Z");
        softwareVersionMap.put("nodejs:node.js", "2019-03-06T00:00Z");
        softwareVersionMap.put("matrixssl:matrixssl", "2019-09-11T00:00Z");
        softwareVersionMap.put("arm:mbed_tls", "2019-09-06T00:00Z");
        softwareVersionMap.put("wolfssl:wolfssl", "2019-10-22T00:00Z");
        softwareVersionMap.put("openssl:openssl", "2019-09-10T00:00Z");
        softwareVersionMap.put("google:chrome", "2019-06-04T00:00Z");
    }

    public LocalDateTime getLastReleaseDate(String softwareName) {
        String version = (String)softwareVersionMap.get(softwareName);
        DateTimeFormatter dateFormatter = DateTimeFormatter.ofPattern("yyyy-MM-dd'T'HH:mm'Z'", Locale.ENGLISH);
        LocalDateTime lastReleaseDate = LocalDateTime.parse(version, dateFormatter);
        return lastReleaseDate;
//        Issue issue = null;
//        Github github = new RtGithub("token");
//        Repo repo = github.repos().get(
//          new Coordinates.Simple(software)
//        );
        //Releases r = repo.releases().get(0).assets().get(;
        //System.out.println(r); 
    }

}
